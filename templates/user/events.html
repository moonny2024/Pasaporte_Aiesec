{% extends 'layouts/base_user.html' %}

{% block title %}Mis Eventos{% endblock %} <!-- Titulo que aparece en la pestaña del navegador -->

{% block content %}
<div class="container py-4 contenedor-main">
    <div class="events-page-content">
        <header class="page-header">
            <h1>Calendario de Liderazgo</h1>
        </header>

        <!-- Resumen: Evento de hoy o el más próximo -->
        <section class="dashboard-section">
            <h2 class="section-title">Hoy / Próximo evento</h2>
            {% if events|length == 0 %}
                <div class="highlight-card">
                    <div class="event-card event-type-conference">
                        <div class="card-details">
                            <div class="event-type-tag tag-conference">LCM</div>
                            <h3 class="event-name">LC Meeting - Enero</h3>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>Auditorio Central, Campus</p>
                        </div>
                        <div class="card-action">
                            <div class="event-date-box">
                                <span class="day">24</span>
                                <span class="month">ENE</span>
                            </div>
                            <button class="action-btn register-btn"><i class="fas fa-calendar-plus"></i> Registrarte</button>
                        </div>
                    </div>
                </div>
            {% else %}
                {% set ordered = events|sort(attribute='date') %}
                {% set next = ordered[0] %}
                {% set next_cat_raw = next.category if next.category is string else '' %}
                <div class="highlight-card" data-category="{{ next_cat_raw|lower }}">
                    <div class="event-card event-type-conference" data-date="{{ next.date.strftime('%Y-%m-%d') }}" data-time="{{ next.time_start }}">
                        <div class="card-details">
                            <div class="event-type-tag tag-conference">{{ next.category }}</div>
                            <h3 class="event-name">{{ next.name }}</h3>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>{{ next.description }}</p>
                        </div>
                        <div class="card-action">
                            <div class="event-date-box">
                                <span class="day">{{ next.date.strftime('%d') }}</span>
                                <span class="month">{{ next.date.strftime('%b').upper() }}</span>
                            </div>
                            <button class="action-btn registered-btn"><i class="fas fa-check"></i> Registrado</button>
                        </div>
                    </div>
                </div>
            {% endif %}
        </section>

        <!-- Reuniones de área (Area Meeting) -->
        <section class="dashboard-section">
            <h2 class="section-title">Reuniones de área</h2>
            <div class="events-grid">
            {% if events|length == 0 %}
                <div class="event-card event-type-workshop">
                    <div class="card-details">
                        <div class="event-type-tag tag-workshop">Area Meeting</div>
                        <h3 class="event-name">Área Marketing - Sprint Q1</h3>
                        <p class="event-location"><i class="fas fa-map-marker-alt"></i>Sala 203, Edificio B</p>
                    </div>
                    <div class="card-action">
                        <div class="event-date-box">
                            <span class="day">26</span>
                            <span class="month">ENE</span>
                        </div>
                        <button class="action-btn register-btn"><i class="fas fa-calendar-plus"></i> Registrarte</button>
                    </div>
                </div>
                <div class="event-card event-type-workshop">
                    <div class="card-details">
                        <div class="event-type-tag tag-workshop">Area Meeting</div>
                        <h3 class="event-name">Área Finanzas - Presupuesto 2026</h3>
                        <p class="event-location"><i class="fas fa-map-marker-alt"></i>Sala 105, Edificio A</p>
                    </div>
                    <div class="card-action">
                        <div class="event-date-box">
                            <span class="day">28</span>
                            <span class="month">ENE</span>
                        </div>
                        <button class="action-btn register-btn"><i class="fas fa-calendar-plus"></i> Registrarte</button>
                    </div>
                </div>
            {% else %}
                {% for event in events %}
                    {% set cat_raw = event.category if event.category is string else '' %}
                    {% set cat = cat_raw|lower %}
                    {% set name_lower = (event.name|lower) %}
                    {% if 'area' in cat or 'meeting' in cat or 'area' in name_lower %}
                    <div class="event-card event-type-conference" data-category="{{ cat }}" data-date="{{ event.date.strftime('%Y-%m-%d') }}" data-time="{{ event.time_start }}">
                        <div class="card-details">
                            <div class="event-type-tag tag-conference">{{ event.category }}</div>
                            <h3 class="event-name">{{ event.name }}</h3>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>{{ event.description }}</p>
                        </div>
                        <div class="card-action">
                            <div class="event-date-box">
                                <span class="day">{{ event.date.strftime('%d') }}</span>
                                <span class="month">{{ event.date.strftime('%b').upper() }}</span>
                            </div>
                            <button class="action-btn registered-btn"><i class="fas fa-check"></i> Registrado</button>
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            {% endif %}
            </div>
        </section>

        <!-- Eventos generales (LCM, LCDay) -->
        <section class="dashboard-section">
            <h2 class="section-title">Eventos generales (LCM, LCDay)</h2>
            <div class="events-grid">
            {% if events|length == 0 %}
                <div class="event-card event-type-conference">
                    <div class="card-details">
                        <div class="event-type-tag tag-conference">LCM</div>
                        <h3 class="event-name">LCM Enero - Kickoff</h3>
                        <p class="event-location"><i class="fas fa-map-marker-alt"></i>Auditorio Central</p>
                    </div>
                    <div class="card-action">
                        <div class="event-date-box">
                            <span class="day">31</span>
                            <span class="month">ENE</span>
                        </div>
                        <button class="action-btn register-btn"><i class="fas fa-calendar-plus"></i> Registrarte</button>
                    </div>
                </div>
                <div class="event-card event-type-social">
                    <div class="card-details">
                        <div class="event-type-tag tag-social">LCDay</div>
                        <h3 class="event-name">LC Day - Integración</h3>
                        <p class="event-location"><i class="fas fa-map-marker-alt"></i>Plaza Campus</p>
                    </div>
                    <div class="card-action">
                        <div class="event-date-box">
                            <span class="day">02</span>
                            <span class="month">FEB</span>
                        </div>
                        <button class="action-btn register-btn"><i class="fas fa-calendar-plus"></i> Registrarte</button>
                    </div>
                </div>
            {% else %}
                {% for event in events %}
                    {% set cat_raw = event.category if event.category is string else '' %}
                    {% set cat = cat_raw|lower %}
                    {% set name_lower = (event.name|lower) %}
                    {% if 'lcm' in cat or 'lcd' in cat or 'lc day' in cat or 'lcm' in name_lower or 'lcd' in name_lower %}
                    <div class="event-card event-type-conference" data-category="{{ cat }}" data-date="{{ event.date.strftime('%Y-%m-%d') }}" data-time="{{ event.time_start }}">
                        <div class="card-details">
                            <div class="event-type-tag tag-conference">{{ event.category }}</div>
                            <h3 class="event-name">{{ event.name }}</h3>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>{{ event.description }}</p>
                        </div>
                        <div class="card-action">
                            <div class="event-date-box">
                                <span class="day">{{ event.date.strftime('%d') }}</span>
                                <span class="month">{{ event.date.strftime('%b').upper() }}</span>
                            </div>
                            <button class="action-btn registered-btn"><i class="fas fa-check"></i> Registrado</button>
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            {% endif %}
            </div>
        </section>

        <!-- Resto de eventos del mes -->
        <section class="dashboard-section">
            <h2 class="section-title">Resto del mes</h2>
            <div class="events-grid">
            {% if events|length == 0 %}
                <div class="event-card event-type-conference">
                    <div class="card-details">
                        <div class="event-type-tag tag-conference">Workshop</div>
                        <h3 class="event-name">Taller de Liderazgo</h3>
                        <p class="event-location"><i class="fas fa-map-marker-alt"></i>Aula Magna</p>
                    </div>
                    <div class="card-action">
                        <div class="event-date-box">
                            <span class="day">05</span>
                            <span class="month">FEB</span>
                        </div>
                        <button class="action-btn register-btn"><i class="fas fa-calendar-plus"></i> Registrarte</button>
                    </div>
                </div>
                <div class="event-card event-type-social">
                    <div class="card-details">
                        <div class="event-type-tag tag-social">Social</div>
                        <h3 class="event-name">Café con el Comité</h3>
                        <p class="event-location"><i class="fas fa-map-marker-alt"></i>Cafetería Campus</p>
                    </div>
                    <div class="card-action">
                        <div class="event-date-box">
                            <span class="day">07</span>
                            <span class="month">FEB</span>
                        </div>
                        <button class="action-btn register-btn"><i class="fas fa-calendar-plus"></i> Registrarte</button>
                    </div>
                </div>
            {% else %}
                {% for event in events %}
                    {% set cat_raw = event.category if event.category is string else '' %}
                    {% set cat = cat_raw|lower %}
                    {% set name_lower = (event.name|lower) %}
                    {% if not('area' in cat or 'meeting' in cat or 'area' in name_lower or 'lcm' in cat or 'lcd' in cat or 'lc day' in cat or 'lcm' in name_lower or 'lcd' in name_lower) %}
                    <div class="event-card event-type-conference" data-category="{{ cat }}" data-date="{{ event.date.strftime('%Y-%m-%d') }}" data-time="{{ event.time_start }}">
                        <div class="card-details">
                            <div class="event-type-tag tag-conference">{{ event.category }}</div>
                            <h3 class="event-name">{{ event.name }}</h3>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>{{ event.description }}</p>
                        </div>
                        <div class="card-action">
                            <div class="event-date-box">
                                <span class="day">{{ event.date.strftime('%d') }}</span>
                                <span class="month">{{ event.date.strftime('%b').upper() }}</span>
                            </div>
                            <button class="action-btn registered-btn"><i class="fas fa-check"></i> Registrado</button>
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            {% endif %}
            </div>
        </section>

    </div>
</div>
{% endblock %}